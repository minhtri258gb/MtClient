<!doctype html>
<html lang="vi">
<head>
	
	<title>ldcover</title>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	
	<link href="/lib/ldcover/index.min.css" type="text/css" rel="stylesheet">
	<link href="/lib/ldcover/ldcv.effects.min.css" type="text/css" rel="stylesheet">
	<script src='/lib/ldcover/index.min.js'></script>

	<style>
		/* overlay (ldcover) */
		.ldcover {
			position: fixed;
			inset: 0;
			display: none; /* hidden by default */
			align-items: center;
			justify-content: center;
			background: rgba(0,0,0,0.5);
			z-index: 1000;
			transition: opacity 180ms ease;
			opacity: 0;
		}
		.ldcover.show {
			display: flex;
			opacity: 1;
		}

		/* modal box */
		.ldcover__dialog {
			width: min(720px, 92%);
			max-height: 90vh;
			overflow: auto;
			background: #fff;
			border-radius: 10px;
			box-shadow: 0 8px 30px rgba(0,0,0,0.25);
			padding: 20px;
			transform: translateY(6px);
			transition: transform 200ms ease, opacity 160ms ease;
			opacity: 1;
		}
		.ldcover.show .ldcover__dialog {
			transform: translateY(0);
		}

		/* header / actions */
		.modal-header {
			display: flex;
			align-items: center;
			justify-content: space-between;
			gap: 12px;
			margin-bottom: 8px;
		}
		.modal-title {
			font-size: 1.1rem;
			font-weight: 600;
		}
		.btn {
			font: inherit;
			padding: 8px 12px;
			border-radius: 6px;
			border: 1px solid #ddd;
			background: #f6f6f6;
			cursor: pointer;
		}
		.btn-primary {
			background: #1e88e5;
			color: #fff;
			border-color: #1e88e5;
		}

		/* small responsiveness */
		@media (prefers-reduced-motion: reduce) {
			.ldcover, .ldcover__dialog { transition: none; }
		}
	</style>
</head>
<body>
	
	<!--
		https://github.com/loadingio/ldcover
	-->

	<main style="padding:24px; font-family: system-ui,Segoe UI,Roboto,Helvetica,Arial, sans-serif;">
		<h1>Ví dụ modal với <code>ldcover</code></h1>
		<p>Mẫu đơn giản: bấm nút dưới để mở modal.</p>

		<button id="openModalBtn" class="btn btn-primary">Mở Modal</button>
	</main>

	<!-- ldcover overlay -->
	<div id="ldcover" class="ldcover" role="presentation" aria-hidden="true">
		<!-- dialog -->
		<div class="ldcover__dialog" role="dialog" aria-modal="true" aria-labelledby="modalTitle" tabindex="-1">
			<div class="modal-header">
				<div class="modal-title" id="modalTitle">Tiêu đề Modal</div>
				<div>
					<button id="closeModalBtn" class="btn" aria-label="Đóng">Đóng</button>
				</div>
			</div>

			<div class="modal-body">
				<p>Đây là nội dung modal. Bạn có thể đặt form, text, hình ảnh, v.v.</p>
				<p><button class="btn">Một nút mẫu</button> <a href="#" class="btn">Liên kết mẫu</a></p>
			</div>

			<div style="margin-top:14px; text-align:right;">
				<button id="actionOk" class="btn btn-primary">OK</button>
			</div>
		</div>
	</div>

	<script>
		(function () {
			const ldcover = document.getElementById('ldcover');
			const openBtn = document.getElementById('openModalBtn');
			const closeBtn = document.getElementById('closeModalBtn');
			const actionOk = document.getElementById('actionOk');
			const dialog = ldcover.querySelector('[role="dialog"]');

			let lastFocused = null;

			function showModal() {
				lastFocused = document.activeElement;
				ldcover.classList.add('show');
				ldcover.setAttribute('aria-hidden', 'false');
				// give focus to dialog for keyboard users
				dialog.focus();
				document.addEventListener('keydown', onKeyDown);
				document.body.style.overflow = 'hidden'; // prevent page scroll
			}

			function hideModal() {
				ldcover.classList.remove('show');
				ldcover.setAttribute('aria-hidden', 'true');
				document.removeEventListener('keydown', onKeyDown);
				document.body.style.overflow = '';
				// restore focus
				if (lastFocused && typeof lastFocused.focus === 'function') {
					lastFocused.focus();
				}
			}

			function onKeyDown(e) {
				if (e.key === 'Escape') {
					hideModal();
				} else if (e.key === 'Tab') {
					trapFocus(e);
				}
			}

			// click outside to close: if click on overlay (not dialog), close
			ldcover.addEventListener('click', (e) => {
				if (e.target === ldcover) hideModal();
			});

			openBtn.addEventListener('click', showModal);
			closeBtn.addEventListener('click', hideModal);
			actionOk.addEventListener('click', () => {
				// sample action
				alert('Bạn bấm OK');
				hideModal();
			});

			// Basic focus trap implementation
			function trapFocus(e) {
				const focusableSelectors = [
					'a[href]', 'button:not([disabled])', 'textarea:not([disabled])', 'input:not([disabled])',
					'select:not([disabled])', '[tabindex]:not([tabindex^="-"])'
				];
				const focusables = Array.from(dialog.querySelectorAll(focusableSelectors.join(',')))
					.filter(el => el.offsetWidth || el.offsetHeight || el.getClientRects().length);

				if (focusables.length === 0) {
					e.preventDefault();
					return;
				}

				const first = focusables[0];
				const last = focusables[focusables.length - 1];
				const current = document.activeElement;

				if (!e.shiftKey && current === last) {
					first.focus();
					e.preventDefault();
				} else if (e.shiftKey && current === first) {
					last.focus();
					e.preventDefault();
				}
				// otherwise allow normal tab flow
			}

			// optional: expose helpers globally if someone wants to control from console
			window.ldcoverModal = { open: showModal, close: hideModal };
		})();
	</script>
	
	<script type="module">
		var mt = {
			m_modal: null,

			init() {

				// Bind Global
				window.mt = this;

				// Init Modal
				// var ldcv = new ldcover({ ... });
			},
			openModal() {
				// this.m_modal.open();
			},
		};
		mt.init();
	</script>

</body>
</html>
