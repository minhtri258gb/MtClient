<!DOCTYPE html>
<html lang="en">
<head>

	<title>Hello World PWA</title>

	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="stylesheet" href="/pwa/styles.css">
	<link rel="manifest" href="/pwa/manifest.json">
	<!-- Other PWA support -->
	<meta name="mobile-web-app-capable" content="yes">
	<!-- iOS meta tags for better PWA support -->
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<link rel="apple-touch-icon" href="/pwa/icon-192x192.png">

</head>
<body>
	<div class="container">
		<h1>Hello World!</h1>
		<p>This is a simple Progressive Web App.</p>
		<button id="install-button" style="display: none;">Install App</button>
	</div>
	<script type="module">
		var mt = {
			init() {

				// Bind Global
				window.mt = this;

				// Init PWA
				this.initPWA();
			},
			initPWA() {

				// Register Service Worker
				if ('serviceWorker' in navigator) {
					window.addEventListener('load', () => {
						navigator.serviceWorker.register('/pwa/service-worker.js')
							.then(reg => console.log('Service Worker registered'))
							.catch(err => console.log('Service Worker registration failed:', err));
					});
				}

				// Handle Install Prompt
				let deferredPrompt;
				window.addEventListener('beforeinstallprompt', (e) => {
					e.preventDefault();
					deferredPrompt = e;
					const installButton = document.getElementById('install-button');
					installButton.style.display = 'block';
					installButton.addEventListener('click', () => {
						deferredPrompt.prompt();
						deferredPrompt.userChoice.then(choice => {
							if (choice.outcome === 'accepted') {
								console.log('User accepted the install prompt');
							}
							deferredPrompt = null;
						});
					});
				});

			},
		};
		mt.init();
	</script>

</body>
</html>